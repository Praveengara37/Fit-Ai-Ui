# FitAI Meal Tracking Feature - Web Frontend PRD

## ROLE
You are a senior frontend developer with 10+ years of experience building nutrition and meal tracking web applications. You have deep expertise in Next.js 14 (App Router), React, TypeScript, Tailwind CSS, form handling, data visualization with charts, and creating intuitive nutrition tracking interfaces. You've built production nutrition dashboards used by millions of users.

## PROBLEM STATEMENT

### Current State
FitAI web app currently has:
- Authentication (login, register)
- Profile management
- Step tracking analytics (beautiful charts, heatmap)
- Dark theme UI (#1a1625 background, #a855f7 purple, #22d3ee cyan)

### The Gap
Users cannot track meals or nutrition on web. There's no way to:
- Search for foods
- Log meals (breakfast, lunch, dinner, snacks)
- View daily nutrition totals
- See weekly nutrition trends
- Manage nutrition goals
- Analyze eating patterns

### User Need
Users need a web interface that:
1. Searches foods easily (keyboard-friendly, fast)
2. Logs meals quickly (big screen advantage)
3. Shows daily nutrition dashboard (calories, macros)
4. Displays weekly trends with charts
5. Manages nutrition goals (custom calories, macros)
6. Provides meal history and analytics

### Why Web (vs Mobile)
**Web Advantages:**
- âœ… Keyboard typing (faster food search)
- âœ… Big screen (see more data)
- âœ… Multi-window (compare meals, plan ahead)
- âœ… Better for analytics (charts, trends)
- âœ… Meal planning (desktop workflow)

**Mobile for:** Quick logging on-the-go, barcode scanning
**Web for:** Detailed logging, planning, analysis

## TECHNICAL CONTEXT

### Existing Setup
**Frontend Stack:**
- Framework: Next.js 14 (App Router)
- Language: TypeScript (strict mode)
- Styling: Tailwind CSS
- Charts: Recharts (already installed for steps)
- HTTP: Axios with cookie auth
- State: React hooks

**Project Structure:**
```
fitai-frontend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ dashboard/page.tsx       # Main dashboard
â”‚   â”œâ”€â”€ steps/
â”‚   â”‚   â””â”€â”€ analytics/page.tsx  # Step analytics
â”‚   â”œâ”€â”€ profile/page.tsx        # Profile
â”‚   â””â”€â”€ login/page.tsx          # Login
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ analytics/              # Step analytics components
â”‚   â”œâ”€â”€ ui/                     # Reusable UI components
â”‚   â””â”€â”€ AuthProvider.tsx        # Auth context
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ api.ts                  # Axios instance
â”‚   â””â”€â”€ analytics.ts            # Step analytics functions
â””â”€â”€ types/
    â””â”€â”€ index.ts                # TypeScript types
```

**Design System:**
```typescript
Colors = {
  background: '#1a1625',
  foreground: '#e5e5e5',
  card: '#2a2235',
  border: 'rgba(168, 85, 247, 0.3)',
  purple: '#a855f7',
  cyan: '#22d3ee',
  success: '#22c55e',
  warning: '#f59e0b',
  error: '#ef4444',
}
```

### Backend API Endpoints (Already Built)

```
GET  /api/foods/search?query=chicken&maxResults=10
GET  /api/foods/:foodId

POST /api/meals/log
Body: { mealType, date, foods: [...], notes }

GET  /api/meals/today
GET  /api/meals/history?startDate=...&endDate=...
GET  /api/meals/stats?period=week

PATCH /api/meals/:mealId
DELETE /api/meals/:mealId

POST /api/nutrition/goals
Body: { dailyCalories, dailyProtein, dailyCarbs, dailyFat }

GET  /api/nutrition/goals
```

## REQUIREMENTS

### FR1: Dashboard Nutrition Widget

**Location:** Update `app/dashboard/page.tsx`

**Add Nutrition Summary Card:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ½ï¸ Today's Nutrition              â”‚
â”‚                                    â”‚
â”‚ 1,565 / 2,000 calories            â”‚
â”‚ â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘ 78%               â”‚
â”‚                                    â”‚
â”‚ Protein:  85g / 150g  â–“â–“â–“â–“â–“â–‘     â”‚
â”‚ Carbs:   180g / 250g  â–“â–“â–“â–“â–“â–“â–‘    â”‚
â”‚ Fat:      45g / 65g   â–“â–“â–“â–“â–“â–‘     â”‚
â”‚                                    â”‚
â”‚ [+ Log Meal] [View Details â†’]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Features:**
- Fetch today's meals on mount
- Show total calories with progress bar
- Show macros with mini progress bars
- Quick "Log Meal" button (opens modal or navigates)
- "View Details" link to full nutrition page
- Loading skeleton while fetching
- Empty state if no meals logged

---

### FR2: Food Search Interface

**Location:** Create `app/meals/log/page.tsx` or modal component

**Layout:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Log Meal                                 â”‚
â”‚                                          â”‚
â”‚ Meal Type:                               â”‚
â”‚ [â—Breakfast] [ Lunch ] [ Dinner ] [Snack]â”‚
â”‚                                          â”‚
â”‚ Search Food:                             â”‚
â”‚ [chicken breast____________] ğŸ”         â”‚
â”‚                                          â”‚
â”‚ Results:                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Chicken Breast                       â”‚â”‚
â”‚ â”‚ 165 cal | 31g protein | 0g carbs     â”‚â”‚
â”‚ â”‚ Serving: 100g                        â”‚â”‚
â”‚ â”‚ [+ Add]                              â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Chicken Breast, Grilled (McDonald's) â”‚â”‚
â”‚ â”‚ 180 cal | 28g protein | 2g carbs     â”‚â”‚
â”‚ â”‚ Brand: McDonald's                    â”‚â”‚
â”‚ â”‚ [+ Add]                              â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                          â”‚
â”‚ Added Foods:                             â”‚
â”‚ â€¢ Chicken Breast (200g) - 330 cal [Edit]â”‚
â”‚ â€¢ Rice (150g) - 195 cal [Edit] [Remove] â”‚
â”‚                                          â”‚
â”‚ Total: 525 calories                      â”‚
â”‚ [Save Meal]                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Features:**
1. **Meal Type Selector:** Radio buttons (Breakfast, Lunch, Dinner, Snack)
2. **Search Input:** 
   - Debounced search (300ms)
   - Min 2 characters
   - Clear button
   - Keyboard shortcuts (Enter to search)
3. **Search Results:**
   - Max 10 results
   - Show: Name, calories, protein, carbs, fat, serving size
   - Brand name if available
   - "Add" button per food
4. **Added Foods List:**
   - Show all foods being added
   - Editable serving size
   - Remove button
   - Running total
5. **Save Button:**
   - Disabled until at least 1 food added
   - Shows loading state
   - Success message on save
   - Navigate to meals page or close modal

**Implementation:**
```typescript
// components/meals/FoodSearch.tsx
export function FoodSearch({ onAdd }: { onAdd: (food: Food) => void }) {
  const [query, setQuery] = useState('');
  const [results, setResults] = useState<Food[]>([]);
  const [loading, setLoading] = useState(false);

  const searchFoods = useDebouncedCallback(async (searchQuery: string) => {
    if (searchQuery.length < 2) return;
    
    setLoading(true);
    try {
      const response = await api.get('/api/foods/search', {
        params: { query: searchQuery, maxResults: 10 }
      });
      setResults(response.data.data.foods);
    } catch (error) {
      toast.error('Failed to search foods');
    } finally {
      setLoading(false);
    }
  }, 300);

  return (
    <div>
      <input
        type="text"
        value={query}
        onChange={(e) => {
          setQuery(e.target.value);
          searchFoods(e.target.value);
        }}
        placeholder="Search for foods..."
        className="w-full p-3 bg-card border border-border rounded-lg"
      />
      
      {loading && <LoadingSkeleton />}
      
      {results.map(food => (
        <FoodResult key={food.foodId} food={food} onAdd={onAdd} />
      ))}
    </div>
  );
}
```

---

### FR3: Meal Details Page

**Location:** Create `app/meals/page.tsx`

**Layout:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Today's Meals                             â”‚
â”‚ Saturday, February 22, 2026               â”‚
â”‚                                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Breakfast - 450 calories             â”‚ â”‚
â”‚ â”‚ 8:30 AM                              â”‚ â”‚
â”‚ â”‚                                      â”‚ â”‚
â”‚ â”‚ â€¢ Oatmeal (2 cups) - 300 cal        â”‚ â”‚
â”‚ â”‚   Protein: 10g | Carbs: 54g | Fat: 6gâ”‚ â”‚
â”‚ â”‚                                      â”‚ â”‚
â”‚ â”‚ â€¢ Banana (1 medium) - 150 cal       â”‚ â”‚
â”‚ â”‚   Protein: 1g | Carbs: 27g | Fat: 0gâ”‚ â”‚
â”‚ â”‚                                      â”‚ â”‚
â”‚ â”‚ [Edit] [Delete]                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Lunch - 550 calories                 â”‚ â”‚
â”‚ â”‚ 1:00 PM                              â”‚ â”‚
â”‚ â”‚                                      â”‚ â”‚
â”‚ â”‚ â€¢ Chicken Breast (200g) - 330 cal   â”‚ â”‚
â”‚ â”‚ â€¢ Brown Rice (150g) - 220 cal       â”‚ â”‚
â”‚ â”‚                                      â”‚ â”‚
â”‚ â”‚ [Edit] [Delete]                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Daily Summary                        â”‚ â”‚
â”‚ â”‚                                      â”‚ â”‚
â”‚ â”‚ Total: 1,000 / 2,000 calories       â”‚ â”‚
â”‚ â”‚ Protein: 60g / 150g                 â”‚ â”‚
â”‚ â”‚ Carbs: 115g / 250g                  â”‚ â”‚
â”‚ â”‚ Fat: 30g / 65g                      â”‚ â”‚
â”‚ â”‚                                      â”‚ â”‚
â”‚ â”‚ Remaining: 1,000 calories           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                           â”‚
â”‚ [+ Log New Meal]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Features:**
1. **Meal Cards:** Each meal type shown separately
2. **Food Details:** Expandable to show all macros
3. **Edit Meal:** Modal to edit serving sizes or remove foods
4. **Delete Meal:** Confirmation dialog
5. **Daily Summary:** Large card at bottom
6. **Add Meal:** Floating action button or prominent button
7. **Date Selector:** View past days
8. **Empty State:** "No meals logged today. Start tracking!"

---

### FR4: Nutrition Analytics Page

**Location:** Create `app/meals/analytics/page.tsx`

**Layout:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Nutrition Analytics                          â”‚
â”‚ [Week] [Month] [Year]                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚ This Week   â”‚ â”‚ Daily Avg   â”‚            â”‚
â”‚ â”‚ 13,650 cal  â”‚ â”‚ 1,950 cal   â”‚            â”‚
â”‚ â”‚ â†‘ 8% vs     â”‚ â”‚ vs goal     â”‚            â”‚
â”‚ â”‚ last week   â”‚ â”‚ 2,000 cal   â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Calories This Week                       â”‚â”‚
â”‚ â”‚                                          â”‚â”‚
â”‚ â”‚ [Area Chart - 7 days]                   â”‚â”‚
â”‚ â”‚ Shows daily calories with goal line     â”‚â”‚
â”‚ â”‚                                          â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Macronutrient Breakdown                  â”‚â”‚
â”‚ â”‚                                          â”‚â”‚
â”‚ â”‚ [Stacked Bar Chart]                     â”‚â”‚
â”‚ â”‚ Daily protein, carbs, fat               â”‚â”‚
â”‚ â”‚                                          â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Weekly Summary                           â”‚â”‚
â”‚ â”‚                                          â”‚â”‚
â”‚ â”‚ Total Calories: 13,650                  â”‚â”‚
â”‚ â”‚ Avg Calories: 1,950/day                 â”‚â”‚
â”‚ â”‚ Days on Track: 5/7                      â”‚â”‚
â”‚ â”‚ Best Day: Tuesday (2,100 cal)           â”‚â”‚
â”‚ â”‚                                          â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Features:**
1. **Period Selector:** Toggle week/month/year
2. **KPI Cards:** This week total, daily average, comparison
3. **Calorie Chart:** Area chart showing daily calories + goal line
4. **Macro Chart:** Stacked bar chart (protein/carbs/fat per day)
5. **Summary Stats:** Text-based statistics
6. **Responsive:** Adapts to screen size

**Chart Implementation:**
```typescript
import { AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, ReferenceLine } from 'recharts';

export function CalorieChart({ data, goal }: { data: any[], goal: number }) {
  return (
    <ResponsiveContainer width="100%" height={300}>
      <AreaChart data={data}>
        <defs>
          <linearGradient id="colorCalories" x1="0" y1="0" x2="0" y2="1">
            <stop offset="5%" stopColor="#a855f7" stopOpacity={0.8}/>
            <stop offset="95%" stopColor="#a855f7" stopOpacity={0}/>
          </linearGradient>
        </defs>
        <XAxis dataKey="date" stroke="#9ca3af" />
        <YAxis stroke="#9ca3af" />
        <CartesianGrid strokeDasharray="3 3" stroke="#2a2235" />
        <Tooltip 
          contentStyle={{ backgroundColor: '#2a2235', border: 'none' }}
        />
        <ReferenceLine y={goal} stroke="#22d3ee" strokeDasharray="5 5" label="Goal" />
        <Area 
          type="monotone" 
          dataKey="calories" 
          stroke="#a855f7" 
          strokeWidth={3}
          fillOpacity={1} 
          fill="url(#colorCalories)" 
        />
      </AreaChart>
    </ResponsiveContainer>
  );
}
```

---

### FR5: Nutrition Goals Page

**Location:** Create `app/meals/goals/page.tsx`

**Layout:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Nutrition Goals                      â”‚
â”‚                                      â”‚
â”‚ Set your daily nutrition targets    â”‚
â”‚                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Daily Calorie Goal               â”‚â”‚
â”‚ â”‚ [2000_____] calories             â”‚â”‚
â”‚ â”‚                                  â”‚â”‚
â”‚ â”‚ Recommended: 2,200 cal           â”‚â”‚
â”‚ â”‚ (Based on your activity level)   â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Macronutrient Goals              â”‚â”‚
â”‚ â”‚                                  â”‚â”‚
â”‚ â”‚ Protein: [150___] grams         â”‚â”‚
â”‚ â”‚ Goal: 30% of calories (600 cal) â”‚â”‚
â”‚ â”‚                                  â”‚â”‚
â”‚ â”‚ Carbs: [250___] grams           â”‚â”‚
â”‚ â”‚ Goal: 50% of calories (1000 cal)â”‚â”‚
â”‚ â”‚                                  â”‚â”‚
â”‚ â”‚ Fat: [65___] grams              â”‚â”‚
â”‚ â”‚ Goal: 20% of calories (400 cal) â”‚â”‚
â”‚ â”‚                                  â”‚â”‚
â”‚ â”‚ Total: 2,000 calories âœ“         â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                      â”‚
â”‚ [ Use Recommended ] [ Save Goals ]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Features:**
1. **Calorie Input:** Number input with validation
2. **Macro Inputs:** Individual inputs for protein, carbs, fat
3. **Live Calculation:** Show calories from macros (proteinÃ—4 + carbsÃ—4 + fatÃ—9)
4. **Validation:** Warn if macros don't add up to calories (Â±10% tolerance)
5. **Recommendations:** Show suggested values based on profile
6. **Save:** POST to /api/nutrition/goals
7. **Success State:** Show confirmation, update dashboard

**Validation Logic:**
```typescript
const validateGoals = (calories: number, protein: number, carbs: number, fat: number) => {
  const calculatedCalories = (protein * 4) + (carbs * 4) + (fat * 9);
  const difference = Math.abs(calculatedCalories - calories);
  const tolerance = calories * 0.1; // 10%

  if (difference > tolerance) {
    return {
      valid: false,
      message: `Macros (${Math.round(calculatedCalories)} cal) don't match calorie goal (${calories} cal)`
    };
  }

  return { valid: true };
};
```

---

### FR6: Meal History Page

**Location:** Create `app/meals/history/page.tsx`

**Layout:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Meal History                             â”‚
â”‚                                          â”‚
â”‚ [Last 7 Days â–¼] [Export CSV]           â”‚
â”‚                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Saturday, Feb 22                     â”‚â”‚
â”‚ â”‚ 1,800 calories | 140g protein        â”‚â”‚
â”‚ â”‚                                      â”‚â”‚
â”‚ â”‚ Breakfast: 450 cal                  â”‚â”‚
â”‚ â”‚ Lunch: 550 cal                      â”‚â”‚
â”‚ â”‚ Dinner: 800 cal                     â”‚â”‚
â”‚ â”‚                                      â”‚â”‚
â”‚ â”‚ [View Details]                      â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Friday, Feb 21                       â”‚â”‚
â”‚ â”‚ 2,100 calories | 160g protein        â”‚â”‚
â”‚ â”‚ [View Details]                      â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                          â”‚
â”‚ ... (7 days)                            â”‚
â”‚                                          â”‚
â”‚ Weekly Average: 1,950 calories          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Features:**
1. **Date Range Selector:** Last 7/14/30 days
2. **Daily Cards:** Collapsible cards per day
3. **Quick Stats:** Calories and protein per day
4. **View Details:** Expand to see all meals and foods
5. **Weekly Summary:** Average at bottom
6. **Export:** Download CSV of history
7. **Pagination:** Load more days on scroll

---

## COMPONENTS TO CREATE

### 1. components/meals/FoodSearch.tsx
Search interface with debouncing

### 2. components/meals/FoodResult.tsx
Single search result card with "Add" button

### 3. components/meals/MealForm.tsx
Complete meal logging form (meal type, food search, added foods)

### 4. components/meals/MealCard.tsx
Display single meal with foods

### 5. components/meals/NutritionSummary.tsx
Daily totals card (calories, macros, progress bars)

### 6. components/meals/CalorieChart.tsx
Area chart for calorie tracking

### 7. components/meals/MacroChart.tsx
Stacked bar chart for macros

### 8. components/meals/GoalsForm.tsx
Nutrition goals input form

### 9. components/ui/ProgressBar.tsx
Reusable progress bar for macros

### 10. components/ui/MacroDisplay.tsx
Display single macro with icon and bar

## DATA FETCHING

**Create:** `lib/meals.ts`

```typescript
import api from './api';

export async function searchFoods(query: string, maxResults = 10) {
  const response = await api.get('/api/foods/search', {
    params: { query, maxResults }
  });
  return response.data.data;
}

export async function getTodayMeals() {
  const response = await api.get('/api/meals/today');
  return response.data.data;
}

export async function logMeal(data: LogMealData) {
  const response = await api.post('/api/meals/log', data);
  return response.data.data;
}

export async function getMealHistory(startDate: string, endDate: string) {
  const response = await api.get('/api/meals/history', {
    params: { startDate, endDate }
  });
  return response.data.data;
}

export async function getMealStats(period: 'week' | 'month' | 'year') {
  const response = await api.get('/api/meals/stats', {
    params: { period }
  });
  return response.data.data;
}

export async function setNutritionGoals(goals: NutritionGoalsData) {
  const response = await api.post('/api/nutrition/goals', goals);
  return response.data.data;
}

export async function getNutritionGoals() {
  const response = await api.get('/api/nutrition/goals');
  return response.data.data;
}

export async function deleteMeal(mealId: string) {
  await api.delete(`/api/meals/${mealId}`);
}
```

## TYPES

**Update:** `types/index.ts`

```typescript
export interface Food {
  foodId: string;
  name: string;
  brandName?: string;
  calories: number;
  protein: number;
  carbs: number;
  fat: number;
  servingSize: number;
  servingUnit: string;
}

export interface MealFood {
  id?: string;
  foodId?: string;
  foodName: string;
  brandName?: string;
  servingSize: number;
  servingUnit: string;
  calories: number;
  protein: number;
  carbs: number;
  fat: number;
}

export interface Meal {
  id: string;
  mealType: 'breakfast' | 'lunch' | 'dinner' | 'snack';
  date: string;
  totalCalories: number;
  totalProtein: number;
  totalCarbs: number;
  totalFat: number;
  notes?: string;
  foods: MealFood[];
  createdAt: string;
}

export interface DailyMeals {
  date: string;
  meals: Meal[];
  totals: {
    calories: number;
    protein: number;
    carbs: number;
    fat: number;
  };
  goals: {
    calories: number;
    protein: number;
    carbs: number;
    fat: number;
  };
  remaining: {
    calories: number;
    protein: number;
    carbs: number;
    fat: number;
  };
}

export interface NutritionGoals {
  dailyCalories: number;
  dailyProtein: number;
  dailyCarbs: number;
  dailyFat: number;
}

export interface MealStats {
  period: 'week' | 'month' | 'year';
  totalCalories: number;
  averageCalories: number;
  totalProtein: number;
  averageProtein: number;
  totalCarbs: number;
  averageCarbs: number;
  totalFat: number;
  averageFat: number;
  daysLogged: number;
  totalMeals: number;
  goalReachedDays: number;
}
```

## STYLING GUIDELINES

**Consistent with existing dark theme:**

```tsx
// Meal card
className="bg-card border border-border rounded-xl p-6"

// Progress bar (calories)
className="h-3 bg-gray-700 rounded-full overflow-hidden"
<div className="h-full bg-gradient-to-r from-purple to-cyan" style={{ width: `${percent}%` }} />

// Macro progress bar (protein)
className="h-2 bg-gray-700 rounded-full"
<div className="h-full bg-purple" style={{ width: `${percent}%` }} />

// Food result card
className="bg-card hover:bg-card/80 border border-border rounded-lg p-4 cursor-pointer transition"

// Button primary
className="bg-purple hover:bg-purple/90 text-white px-6 py-3 rounded-lg font-semibold"

// Input
className="bg-card border border-border rounded-lg px-4 py-3 text-foreground focus:border-purple"
```

## SUCCESS CRITERIA

âœ… Food search returns results in <500ms  
âœ… Meal logging saves successfully  
âœ… Daily totals calculate correctly  
âœ… Charts render properly with data  
âœ… Goals validation works  
âœ… All forms have proper error handling  
âœ… Loading states on all async operations  
âœ… Mobile responsive (works on tablet)  
âœ… Dark theme consistent throughout  
âœ… Keyboard accessible (Tab navigation works)  
âœ… Empty states for no data  
âœ… Success/error messages clear  

## TIMELINE ESTIMATE

**Total: 2 hours**

- Dashboard widget: 15 min
- Food search component: 25 min
- Meal logging form: 30 min
- Meals page: 20 min
- Analytics page: 20 min
- Goals page: 15 min
- History page: 10 min
- Testing & polish: 15 min

Create all files with production-quality code, beautiful UI matching existing design, and excellent UX.